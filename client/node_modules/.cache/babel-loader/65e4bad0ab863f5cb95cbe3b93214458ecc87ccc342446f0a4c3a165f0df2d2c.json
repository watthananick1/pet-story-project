{"ast":null,"code":"var _jsxFileName = \"/Users/watthananick/pet-story-project/client/src/components/feed/Feed.jsx\",\n  _s = $RefreshSig$();\nimport { useContext, useEffect, useState } from \"react\";\nimport Post from \"../post/Post\";\nimport Share from \"../share/Share\";\nimport \"./feed.css\";\nimport axios from \"axios\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport ReactLoading from 'react-loading';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function Feed(_ref) {\n  _s();\n  let {\n    firstName\n  } = _ref;\n  const [posts, setPosts] = useState([]);\n  const {\n    user\n  } = useContext(AuthContext);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    const source = axios.CancelToken.source();\n    const fetchPosts = async () => {\n      try {\n        const res = await axios.get(\"/posts/\" + user.member_id, {\n          cancelToken: source.token\n        });\n        setPosts(res.data.sort((p1, p2) => {\n          const date1 = new Date(p1.createdAt.seconds * 1000 + p1.createdAt.nanoseconds / 1000000);\n          const date2 = new Date(p2.createdAt.seconds * 1000 + p2.createdAt.nanoseconds / 1000000);\n          return date2.getTime() - date1.getTime();\n        }));\n        setLoading(false);\n      } catch (err) {\n        if (axios.isCancel(err)) {\n          console.log('Request canceled:', err.message);\n        } else {\n          console.log(err);\n        }\n        setLoading(false);\n      }\n    };\n    fetchPosts();\n    return () => {\n      source.cancel('Component unmounted');\n      console.log('Component unmounted', source);\n    };\n  }, [user.member_id, firstName, loading]); // Include 'posts' as a dependency\n\n  const handleNewPost = () => {\n    // Logic for adding a new post\n    // After the new post is added, you can set the 'loading' state to true\n    setLoading(true);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"feed\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"feedWrapper\",\n      children: [!firstName || firstName === (user === null || user === void 0 ? void 0 : user.firstName) ? /*#__PURE__*/_jsxDEV(Share, {\n        onNewPost: handleNewPost\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 56\n      }, this) : null, loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loadingWrapper\",\n        children: /*#__PURE__*/_jsxDEV(ReactLoading, {\n          type: \"spin\",\n          color: \"#6200E8\",\n          height: '10%',\n          width: '10%'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: posts.map(p => /*#__PURE__*/_jsxDEV(Post, {\n          post: p\n        }, p.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 15\n        }, this))\n      }, void 0, false)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 5\n  }, this);\n}\n_s(Feed, \"OCLK8PDoajDWXwYRtZrjj6Cc/dk=\");\n_c = Feed;\nvar _c;\n$RefreshReg$(_c, \"Feed\");","map":{"version":3,"names":["useContext","useEffect","useState","Post","Share","axios","AuthContext","ReactLoading","jsxDEV","_jsxDEV","Fragment","_Fragment","Feed","_ref","_s","firstName","posts","setPosts","user","loading","setLoading","source","CancelToken","fetchPosts","res","get","member_id","cancelToken","token","data","sort","p1","p2","date1","Date","createdAt","seconds","nanoseconds","date2","getTime","err","isCancel","console","log","message","cancel","handleNewPost","className","children","onNewPost","fileName","_jsxFileName","lineNumber","columnNumber","type","color","height","width","map","p","post","id","_c","$RefreshReg$"],"sources":["/Users/watthananick/pet-story-project/client/src/components/feed/Feed.jsx"],"sourcesContent":["import { useContext, useEffect, useState } from \"react\";\nimport Post from \"../post/Post\";\nimport Share from \"../share/Share\";\nimport \"./feed.css\";\nimport axios from \"axios\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport ReactLoading from 'react-loading';\n\nexport default function Feed({ firstName }) {\n  const [posts, setPosts] = useState([]);\n  const { user } = useContext(AuthContext);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const source = axios.CancelToken.source();\n  \n    const fetchPosts = async () => {\n      try {\n        const res = await axios.get(\"/posts/\" + user.member_id, {\n          cancelToken: source.token\n        });\n        setPosts(\n          res.data.sort((p1, p2) => {\n            const date1 = new Date(p1.createdAt.seconds * 1000 + p1.createdAt.nanoseconds / 1000000);\n            const date2 = new Date(p2.createdAt.seconds * 1000 + p2.createdAt.nanoseconds / 1000000);\n            return date2.getTime() - date1.getTime();\n          })\n        );\n        setLoading(false);\n      } catch (err) {\n        if (axios.isCancel(err)) {\n          console.log('Request canceled:', err.message);\n        } else {\n          console.log(err);\n        }\n        setLoading(false);\n      }\n    };\n  \n    fetchPosts();\n  \n    return () => {\n      source.cancel('Component unmounted');\n      console.log('Component unmounted', source);\n    };\n  }, [user.member_id, firstName, loading]); // Include 'posts' as a dependency\n  \n  const handleNewPost = () => {\n    // Logic for adding a new post\n    // After the new post is added, you can set the 'loading' state to true\n    setLoading(true);\n  };\n\n  return (\n    <div className=\"feed\">\n      <div className=\"feedWrapper\">\n        {!firstName || firstName === user?.firstName ? <Share onNewPost={handleNewPost} /> : null}\n        {loading ? (\n          <div className=\"loadingWrapper\">\n            <ReactLoading type=\"spin\" color=\"#6200E8\" height={'10%'} width={'10%'} />\n          </div>\n        ) : (\n          <>\n            {posts.map((p) => (\n              <Post key={p.id} post={p} />\n            ))}\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}