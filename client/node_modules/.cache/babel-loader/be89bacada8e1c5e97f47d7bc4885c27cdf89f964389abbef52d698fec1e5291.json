{"ast":null,"code":"var _jsxFileName = \"/Users/watthananick/pet-story-project/client/src/components/post/Post.jsx\",\n  _s = $RefreshSig$();\nimport \"./post.css\";\nimport { useState, useEffect, useContext } from \"react\";\nimport axios from \"axios\";\nimport { format } from \"timeago.js\";\nimport { Link } from \"react-router-dom\";\nimport { Card, CardContent, CardHeader, CardActions, Collapse, Typography, IconButton, Avatar, TextField, Button, Chip, Menu, MenuItem } from \"@mui/material\";\nimport { MoreVert, FavoriteBorder, Favorite, Comment, ExpandMore } from \"@mui/icons-material\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport { SortableContainer, SortableElement } from \"react-sortable-hoc\";\n// import ReactPlayer from 'react-player';\nimport ReactPlayer from 'react-player/lazy';\nimport ReactLoading from 'react-loading';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function Post(_ref) {\n  _s();\n  let {\n    post\n  } = _ref;\n  const [like, setLike] = useState(post.likes.length);\n  const [isLiked, setIsLiked] = useState(false);\n  const [user, setUser] = useState({});\n  const [comments, setComments] = useState([]);\n  const [commentsData, setCommentsData] = useState([]);\n  const [showAllComments, setShowAllComments] = useState(false);\n  const [newCommentText, setNewCommentText] = useState(\"\");\n  const [showComments, setShowComments] = useState(false);\n  const [anchorEl, setAnchorEl] = useState(null);\n  const [anchorElComment, setAnchorElComment] = useState(null);\n  const [commentIdToDelete, setCommentIdToDelete] = useState(null);\n  const [loadingComment, setLoadingComment] = useState(false);\n  const maxDisplayedComments = 3;\n  const {\n    user: currentUser\n  } = useContext(AuthContext);\n  // const PF = process.env.REACT_APP_PUBLIC_FOLDER;\n\n  const createdAt = new Date(post.createdAt.seconds * 1000);\n  const formattedDate = format(createdAt);\n  useEffect(() => {\n    setIsLiked(post.likes.includes(currentUser.member_id));\n  }, [currentUser.member_id, post.likes]);\n  useEffect(() => {\n    const source = axios.CancelToken.source();\n    const fetchUser = async () => {\n      try {\n        const res = await axios.get(`/users?member_id=${post.member_id}&firstName=`);\n        setUser(res.data);\n      } catch (err) {\n        console.log(err);\n      }\n    };\n    const fetchComments = async () => {\n      try {\n        const resComments = await axios.get(`/comments/${post.id}/comments`);\n        setComments(resComments.data);\n        setLoadingComment(true);\n      } catch (err) {\n        console.log(err);\n      } finally {\n        setLoadingComment(false);\n      }\n    };\n    fetchUser();\n    fetchComments();\n    return () => {\n      source.cancel('Component unmounted');\n    };\n  }, [post.member_id, post.id]);\n\n  // console.log(\"comment\",comments) \n\n  useEffect(() => {\n    if (showComments) {\n      const fetchData = async () => {\n        const promises = comments.map(comment => {\n          return axios.get(`/users?member_id=${comment.memberId}&firstName=`);\n        });\n        try {\n          const responses = await Promise.all(promises);\n          const commentUsers = responses.map(res => res.data);\n          setCommentsData(commentUsers);\n          setLoadingComment(true);\n        } catch (err) {\n          console.log(err);\n        } finally {\n          setLoadingComment(false);\n        }\n      };\n      fetchData();\n    } else {\n      // Clear commentsData when showComments is false\n      setCommentsData([]);\n    }\n  }, [comments, showComments]);\n  const handleClick = event => {\n    setAnchorEl(event.currentTarget);\n  };\n  const handleClickComment = (event, id) => {\n    setAnchorElComment(event.currentTarget);\n    setCommentIdToDelete(id); // Store the comment ID in the state\n  };\n\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n  const handleCloseComment = () => {\n    setAnchorElComment(null);\n  };\n  const handleEditPost = () => {\n    // Handle edit action here\n    handleClose();\n  };\n  const handleDeletePost = async () => {\n    const requestBody = {\n      member_id: currentUser.member_id\n    };\n    try {\n      const response = await axios.delete(`/posts/${post.id}`, {\n        data: requestBody\n      });\n      const message = response.data.message;\n      // Handle the response message here\n      console.log(message);\n      window.location.reload();\n      handleClose();\n    } catch (err) {\n      console.log(err);\n    }\n  };\n  const handleDeleteComment = async commentId => {\n    console.log(`Delete Comment ${commentId}`);\n    const requestBody = {\n      member_id: currentUser.member_id\n    };\n    try {\n      const response = await axios.delete(`/comments/${post.id}/comments/${commentId}`, {\n        data: requestBody\n      });\n      const message = response.data.message;\n      // Handle the response message here\n      console.log(message);\n\n      // Fetch the updated comments after deleting the comment\n      const resComments = await axios.get(`/comments/${post.id}/comments`);\n      setComments(resComments.data);\n      handleClose();\n      setLoadingComment(true);\n    } catch (err) {\n      console.log(err);\n    } finally {\n      setLoadingComment(false);\n      handleClose();\n    }\n  };\n  const likeHandler = async () => {\n    try {\n      await axios.put(`/posts/${post.id}/like`, {\n        member_id: currentUser.member_id\n      });\n    } catch (err) {\n      console.log(err);\n    }\n    if (isLiked) {\n      setLike(like - 1);\n    } else {\n      setLike(like + 1);\n    }\n    setIsLiked(!isLiked);\n  };\n  const SortableItem = SortableElement(_ref2 => {\n    let {\n      item\n    } = _ref2;\n    const isImage = post.title === 'image';\n    // console.log(isImage);\n\n    if (isImage) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"shareImgItem\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: item.url,\n          alt: \"Gallery Image\",\n          className: \"shareImg\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 9\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"shareVideoItem\",\n        children: /*#__PURE__*/_jsxDEV(ReactPlayer, {\n          url: item.url,\n          className: \"shareVideo\",\n          width: \"640\",\n          height: \"360\",\n          controls: true,\n          onClick: event => event.preventDefault()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 9\n      }, this);\n    }\n  });\n  const SortableList = SortableContainer(_ref3 => {\n    let {\n      items\n    } = _ref3;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"shareImgContainer\",\n      children: items.map((item, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(SortableItem, {\n          item: item,\n          index: index\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 11\n        }, this)\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 9\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 5\n    }, this);\n  });\n  const submitComment = async () => {\n    try {\n      // Submit the comment\n      await axios.post(`/comments/${post.id}/comments`, {\n        content: newCommentText,\n        member_id: currentUser.member_id\n      });\n\n      // Clear the comment input field\n      setNewCommentText(\"\");\n\n      // Fetch the updated comments\n      const resComments = await axios.get(`/comments/${post.id}/comments`);\n      setComments(resComments.data);\n    } catch (err) {\n      console.log(err);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"post\",\n    children: /*#__PURE__*/_jsxDEV(Card, {\n      className: \"postWrapper\",\n      children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n        avatar: /*#__PURE__*/_jsxDEV(Link, {\n          to: `/profile/${user.firstName}`,\n          children: /*#__PURE__*/_jsxDEV(Avatar, {\n            \"aria-label\": \"recipe\",\n            src: user.profilePicture,\n            style: {\n              width: '39px',\n              height: '39px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 13\n        }, this),\n        title: `${user.firstName} ${user.lastName}`,\n        subheader: formattedDate,\n        action: /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(IconButton, {\n            onClick: handleClick,\n            children: /*#__PURE__*/_jsxDEV(MoreVert, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 278,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Menu, {\n            anchorEl: anchorEl,\n            open: Boolean(anchorEl),\n            onClose: handleClose,\n            keepMounted: true,\n            children: [/*#__PURE__*/_jsxDEV(MenuItem, {\n              onClick: handleEditPost,\n              children: \"Edit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 286,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n              onClick: handleDeletePost,\n              children: \"Delete\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 287,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(CardContent, {\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"body1\",\n          className: \"postText\",\n          children: post === null || post === void 0 ? void 0 : post.content\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"body2\",\n          className: \"postText\",\n          children: post === null || post === void 0 ? void 0 : post.tagpet.map(pet => /*#__PURE__*/_jsxDEV(Chip, {\n            label: `#${pet}`,\n            className: \"postChip\",\n            style: {\n              color: '#6200E8'\n            }\n          }, pet, false, {\n            fileName: _jsxFileName,\n            lineNumber: 298,\n            columnNumber: 13\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(SortableList, {\n          items: post.img.map(item => ({\n            type: item.endsWith('.mp4') ? 'video' : 'image',\n            url: item\n          })),\n          axis: \"xy\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 8\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n        className: \"PostHr\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"postBottom\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"postBottomLeft\",\n          children: /*#__PURE__*/_jsxDEV(CardActions, {\n            disableSpacing: true,\n            children: [isLiked ? /*#__PURE__*/_jsxDEV(IconButton, {\n              \"aria-label\": \"add to favorites\",\n              onClick: likeHandler,\n              children: /*#__PURE__*/_jsxDEV(Favorite, {\n                className: \"likeIcon\",\n                style: {\n                  color: '#6200E8'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 315,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 314,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(IconButton, {\n              \"aria-label\": \"add to favorites\",\n              onClick: likeHandler,\n              children: /*#__PURE__*/_jsxDEV(FavoriteBorder, {\n                className: \"likeIcon\",\n                style: {\n                  color: '#6200E8'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 319,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 318,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"postLikeCounter\",\n              children: [like, \" people like it\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 322,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"postBottomRight\",\n          children: /*#__PURE__*/_jsxDEV(CardActions, {\n            disableSpacing: true,\n            children: /*#__PURE__*/_jsxDEV(IconButton, {\n              \"aria-label\": \"show more\",\n              sx: {\n                color: '#6200E8',\n                right: 14\n              },\n              onClick: () => setShowComments(!showComments),\n              children: [/*#__PURE__*/_jsxDEV(Comment, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 332,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"postCommentText\",\n                underline: \"none\",\n                children: [comments.length, \" comments\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 333,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 327,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 326,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 325,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Collapse, {\n        in: showComments,\n        timeout: \"auto\",\n        unmountOnExit: true,\n        children: [/*#__PURE__*/_jsxDEV(\"hr\", {\n          className: \"PostHr\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 341,\n          columnNumber: 9\n        }, this), loadingComment ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"loadingWrapper\",\n          children: /*#__PURE__*/_jsxDEV(ReactLoading, {\n            type: \"spin\",\n            color: \"#6200E8\",\n            height: '10%',\n            width: '10%'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 344,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 11\n        }, this) : /*#__PURE__*/_jsxDEV(CardContent, {\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            paragraph: true,\n            children: \"Comments\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 348,\n            columnNumber: 13\n          }, this), comments.slice(0, showAllComments ? comments.length : maxDisplayedComments).map((comment, index) => {\n            const commentData = commentsData.find(data => data.member_id === comment.memberId);\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"postComment\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"postCommentProfile\",\n                children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n                  avatar: /*#__PURE__*/_jsxDEV(Avatar, {\n                    \"aria-label\": \"recipe\",\n                    src: commentData === null || commentData === void 0 ? void 0 : commentData.profilePicture,\n                    sx: {\n                      width: '39px',\n                      height: '39px'\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 356,\n                    columnNumber: 25\n                  }, this),\n                  title: `${commentData === null || commentData === void 0 ? void 0 : commentData.firstName} ${commentData === null || commentData === void 0 ? void 0 : commentData.lastName}`,\n                  subheader: `${comment.content}`,\n                  action: /*#__PURE__*/_jsxDEV(_Fragment, {\n                    children: /*#__PURE__*/_jsxDEV(IconButton, {\n                      onClick: event => handleClickComment(event, comment.id),\n                      children: /*#__PURE__*/_jsxDEV(MoreVert, {}, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 367,\n                        columnNumber: 29\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 366,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 354,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(Menu, {\n                  anchorEl: anchorElComment,\n                  open: Boolean(anchorElComment),\n                  onClose: handleCloseComment,\n                  children: [/*#__PURE__*/_jsxDEV(MenuItem, {\n                    onClick: handleEditPost,\n                    children: \"Edit\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 377,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(MenuItem, {\n                    onClick: () => handleDeleteComment(commentIdToDelete),\n                    children: \"Delete\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 378,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 372,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 353,\n                columnNumber: 19\n              }, this)\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 352,\n              columnNumber: 17\n            }, this);\n          }), comments.length > maxDisplayedComments && /*#__PURE__*/_jsxDEV(Typography, {\n            className: \"showMoreComments\",\n            variant: \"body2\",\n            color: \"primary\",\n            onClick: () => setShowAllComments(!showAllComments),\n            children: [showAllComments ? \"Hide\" : \"Show More\", \" Comments\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 385,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(TextField, {\n            label: \"Add a comment\",\n            variant: \"outlined\",\n            value: newCommentText,\n            onChange: e => setNewCommentText(e.target.value),\n            fullWidth: true,\n            style: {\n              color: isLiked ? 'inherit' : '#6200E8'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 394,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            onClick: () => submitComment(post.id, newCommentText, user.member_id),\n            children: \"Comment\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 402,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 347,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 340,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 264,\n    columnNumber: 5\n  }, this);\n}\n_s(Post, \"Mbzlj5wnut9b91ESzWGEDm2uHxg=\");\n_c = Post;\nvar _c;\n$RefreshReg$(_c, \"Post\");","map":{"version":3,"names":["useState","useEffect","useContext","axios","format","Link","Card","CardContent","CardHeader","CardActions","Collapse","Typography","IconButton","Avatar","TextField","Button","Chip","Menu","MenuItem","MoreVert","FavoriteBorder","Favorite","Comment","ExpandMore","AuthContext","SortableContainer","SortableElement","ReactPlayer","ReactLoading","jsxDEV","_jsxDEV","Fragment","_Fragment","Post","_ref","_s","post","like","setLike","likes","length","isLiked","setIsLiked","user","setUser","comments","setComments","commentsData","setCommentsData","showAllComments","setShowAllComments","newCommentText","setNewCommentText","showComments","setShowComments","anchorEl","setAnchorEl","anchorElComment","setAnchorElComment","commentIdToDelete","setCommentIdToDelete","loadingComment","setLoadingComment","maxDisplayedComments","currentUser","createdAt","Date","seconds","formattedDate","includes","member_id","source","CancelToken","fetchUser","res","get","data","err","console","log","fetchComments","resComments","id","cancel","fetchData","promises","map","comment","memberId","responses","Promise","all","commentUsers","handleClick","event","currentTarget","handleClickComment","handleClose","handleCloseComment","handleEditPost","handleDeletePost","requestBody","response","delete","message","window","location","reload","handleDeleteComment","commentId","likeHandler","put","SortableItem","_ref2","item","isImage","title","className","children","src","url","alt","fileName","_jsxFileName","lineNumber","columnNumber","width","height","controls","onClick","preventDefault","SortableList","_ref3","items","index","submitComment","content","avatar","to","firstName","profilePicture","style","lastName","subheader","action","open","Boolean","onClose","keepMounted","variant","tagpet","pet","label","color","img","type","endsWith","axis","disableSpacing","sx","right","underline","in","timeout","unmountOnExit","paragraph","slice","commentData","find","value","onChange","e","target","fullWidth","_c","$RefreshReg$"],"sources":["/Users/watthananick/pet-story-project/client/src/components/post/Post.jsx"],"sourcesContent":["import \"./post.css\";\nimport { useState, useEffect, useContext } from \"react\";\nimport axios from \"axios\";\nimport { format } from \"timeago.js\";\nimport { Link } from \"react-router-dom\";\nimport {\n  Card,\n  CardContent,\n  CardHeader,\n  CardActions,\n  Collapse,\n  Typography,\n  IconButton,\n  Avatar,\n  TextField,\n  Button,\n  Chip,\n  Menu, \n  MenuItem\n} from \"@mui/material\";\nimport { MoreVert, FavoriteBorder, Favorite, Comment, ExpandMore } from \"@mui/icons-material\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport { SortableContainer, SortableElement } from \"react-sortable-hoc\";\n// import ReactPlayer from 'react-player';\nimport ReactPlayer from 'react-player/lazy';\nimport ReactLoading from 'react-loading';\n\nexport default function Post({ post }) {\n  const [like, setLike] = useState(post.likes.length);\n  const [isLiked, setIsLiked] = useState(false);\n  const [user, setUser] = useState({});\n  const [comments, setComments] = useState([]);\n  const [commentsData, setCommentsData] = useState([]);\n  const [showAllComments, setShowAllComments] = useState(false);\n  const [newCommentText, setNewCommentText] = useState(\"\");\n  const [showComments, setShowComments] = useState(false);\n  const [anchorEl, setAnchorEl] = useState(null);\n  const [anchorElComment, setAnchorElComment] = useState(null);\n  const [commentIdToDelete, setCommentIdToDelete] = useState(null);\n  const [loadingComment, setLoadingComment] = useState(false);\n  const maxDisplayedComments = 3;\n  const { user: currentUser } = useContext(AuthContext);\n  // const PF = process.env.REACT_APP_PUBLIC_FOLDER;\n\n  const createdAt = new Date(post.createdAt.seconds * 1000);\n  const formattedDate = format(createdAt);\n\n  useEffect(() => {\n    setIsLiked(post.likes.includes(currentUser.member_id));\n  }, [currentUser.member_id, post.likes]);\n\n  useEffect(() => {\n    const source = axios.CancelToken.source();\n    const fetchUser = async () => {\n      try {\n        const res = await axios.get(`/users?member_id=${post.member_id}&firstName=`);\n        setUser(res.data);\n      } catch (err) {\n        console.log(err);\n      }\n    };\n    \n\n    const fetchComments = async () => {\n\n      try {\n        const resComments = await axios.get(`/comments/${post.id}/comments`);\n        setComments(resComments.data);\n        setLoadingComment(true);\n      } catch (err) {\n        console.log(err);\n      } finally {\n        setLoadingComment(false);\n      } \n    };\n\n    fetchUser();\n    fetchComments();\n    return () => {\n      source.cancel('Component unmounted');\n    };\n  }, [post.member_id, post.id]);\n  \n  // console.log(\"comment\",comments) \n  \n  useEffect(() => {\n    if (showComments) {\n      const fetchData = async () => {\n        const promises = comments.map((comment) => {\n          return axios.get(`/users?member_id=${comment.memberId}&firstName=`);\n        });\n  \n        try {\n          const responses = await Promise.all(promises);\n          const commentUsers = responses.map((res) => res.data);\n          setCommentsData(commentUsers);\n          setLoadingComment(true);\n        } catch (err) {\n          console.log(err);\n        } finally {\n          setLoadingComment(false);\n        } \n      };\n  \n      fetchData();\n    } else {\n      // Clear commentsData when showComments is false\n      setCommentsData([]);\n    }\n  }, [comments, showComments]);  \n  \n  \n   \n  \n    const handleClick = (event) => {\n      setAnchorEl(event.currentTarget);\n    };\n    \n    const handleClickComment = (event, id) => {\n      setAnchorElComment(event.currentTarget);\n      setCommentIdToDelete(id); // Store the comment ID in the state\n    };\n    \n  \n    const handleClose = () => {\n      setAnchorEl(null);\n    };\n    \n    const handleCloseComment = () => {\n      setAnchorElComment(null);\n    };\n  \n    const handleEditPost = () => {\n      // Handle edit action here\n      handleClose();\n    };\n  \n    const handleDeletePost = async () => {\n      const requestBody = {\n        member_id: currentUser.member_id\n      };\n      \n      try {\n        const response = await axios.delete(`/posts/${post.id}`, { data: requestBody });\n        const message = response.data.message;\n        // Handle the response message here\n        console.log(message);\n        window.location.reload();\n        handleClose();\n      } catch (err) {\n        console.log(err);\n      }\n    };\n    \n    const handleDeleteComment = async (commentId) => {\n      console.log(`Delete Comment ${commentId}`);\n      const requestBody = {\n        member_id: currentUser.member_id\n      };\n    \n      try {\n        const response = await axios.delete(`/comments/${post.id}/comments/${commentId}`, { data: requestBody });\n        const message = response.data.message;\n        // Handle the response message here\n        console.log(message);\n    \n        // Fetch the updated comments after deleting the comment\n        const resComments = await axios.get(`/comments/${post.id}/comments`);\n        setComments(resComments.data);\n    \n        handleClose();\n        setLoadingComment(true);\n      } catch (err) {\n        console.log(err);\n      } finally {\n        setLoadingComment(false);\n        handleClose();\n      } \n    };\n\n  const likeHandler = async () => {\n    try {\n      await axios.put(`/posts/${post.id}/like`, { member_id: currentUser.member_id });\n    } catch (err) {\n      console.log(err);\n    }\n\n    if (isLiked) {\n      setLike(like - 1);\n    } else {\n      setLike(like + 1);\n    }\n    setIsLiked(!isLiked);\n  };\n\n  const SortableItem = SortableElement(({ item }) => {\n    const isImage =  post.title === 'image';\n    // console.log(isImage);\n  \n  \n    if (isImage) {\n      return (\n        <div className=\"shareImgItem\">\n          <img src={item.url} alt=\"Gallery Image\" className=\"shareImg\" />\n        </div>\n      );\n    } else {\n      return (\n        <div className=\"shareVideoItem\">\n          {/* <ReactPlayer \n            url={item.url} \n            className=\"shareVideo\" \n            width=\"640\"\n            height=\"360\" \n            controls={true}\n            // playing={true}\n          /> */}\n          <ReactPlayer\n            url={item.url} \n            className=\"shareVideo\" \n            width=\"640\"\n            height=\"360\" \n            controls\n            onClick={(event) => event.preventDefault()}\n          />\n\n        </div>\n      );\n    }\n  });\n  \n\n  \n  const SortableList = SortableContainer(({ items }) => (\n    <div className=\"shareImgContainer\">\n      {items.map((item, index) => (\n        <div key={index}>\n          <SortableItem item={item} index={index} />\n        </div>\n      ))}\n    </div>\n  ));\n\n  const submitComment = async () => {\n    try {\n      // Submit the comment\n      await axios.post(`/comments/${post.id}/comments`, {\n        content: newCommentText,\n        member_id: currentUser.member_id,\n      });\n  \n      // Clear the comment input field\n      setNewCommentText(\"\");\n  \n      // Fetch the updated comments\n      const resComments = await axios.get(`/comments/${post.id}/comments`);\n      setComments(resComments.data);\n    } catch (err) {\n      console.log(err);\n    }\n  };\n  \n  return (\n    <div className=\"post\">\n      <Card className=\"postWrapper\">\n        <CardHeader\n          avatar={\n            <Link to={`/profile/${user.firstName}`}>\n              <Avatar aria-label=\"recipe\" src={user.profilePicture} style={{ width: '39px', height: '39px' }}>\n              </Avatar>\n            </Link>\n          }\n          title={`${user.firstName} ${user.lastName}`}\n          subheader={formattedDate}\n          action={\n            <>\n              <IconButton onClick={handleClick}>\n                <MoreVert />\n              </IconButton>\n              <Menu\n                anchorEl={anchorEl}\n                open={Boolean(anchorEl)}\n                onClose={handleClose}\n                keepMounted\n              >\n                <MenuItem onClick={handleEditPost}>Edit</MenuItem>\n                <MenuItem onClick={handleDeletePost}>Delete</MenuItem>\n              </Menu>\n            </>\n          }\n        />\n       <CardContent>\n        <Typography variant=\"body1\" className=\"postText\">\n          {post?.content}\n        </Typography>\n        <Typography variant=\"body2\" className=\"postText\">\n          {post?.tagpet.map((pet) => (\n            <Chip key={pet} label={`#${pet}`} className=\"postChip\" style={{ color: '#6200E8' }}/>\n          ))}\n        </Typography>\n        <SortableList\n          items={post.img.map((item) => ({\n            type: item.endsWith('.mp4') ? 'video' : 'image',\n            url: item,\n          }))}\n          axis=\"xy\"\n        />\n      </CardContent>\n        <hr className=\"PostHr\" />\n        <div className=\"postBottom\">\n          <div className=\"postBottomLeft\">\n            <CardActions disableSpacing>\n              {isLiked ? (\n                <IconButton aria-label=\"add to favorites\" onClick={likeHandler}>\n                  <Favorite className=\"likeIcon\" style={{ color: '#6200E8' }} />\n                </IconButton>\n              ) : (\n                <IconButton aria-label=\"add to favorites\" onClick={likeHandler}>\n                  <FavoriteBorder className=\"likeIcon\" style={{ color: '#6200E8' }} />\n                </IconButton>\n              )}\n              <span className=\"postLikeCounter\">{like} people like it</span>\n            </CardActions>\n          </div>\n          <div className=\"postBottomRight\">\n            <CardActions disableSpacing>\n              <IconButton\n                aria-label=\"show more\"\n                sx={{ color: '#6200E8',  right: 14 }}\n                onClick={() => setShowComments(!showComments)}\n              >\n                <Comment />\n                <p className=\"postCommentText\" underline=\"none\">\n                   {comments.length} comments\n                </p>\n              </IconButton>\n            </CardActions>\n          </div>\n        </div>\n        <Collapse in={showComments} timeout=\"auto\" unmountOnExit>\n        <hr className=\"PostHr\" />\n        {loadingComment ? (\n          <div className=\"loadingWrapper\">\n            <ReactLoading type=\"spin\" color=\"#6200E8\" height={'10%'} width={'10%'} />\n          </div>\n          ) : (\n          <CardContent>\n            <Typography paragraph>Comments</Typography>\n            {comments.slice(0, showAllComments ? comments.length : maxDisplayedComments).map((comment, index) => {\n              const commentData = commentsData.find(data => data.member_id === comment.memberId);\n              return (\n                <div key={index} className=\"postComment\">\n                  <div className=\"postCommentProfile\">\n                    <CardHeader\n                      avatar={\n                        <Avatar\n                          aria-label=\"recipe\"\n                          src={commentData?.profilePicture}\n                          sx={{ width: '39px', height: '39px' }}\n                        />\n                      }\n                      title={`${commentData?.firstName} ${commentData?.lastName}`}\n                      subheader={`${comment.content}`}\n                      action={\n                        <>\n                          <IconButton onClick={(event) => handleClickComment(event, comment.id)}>\n                            <MoreVert />\n                          </IconButton>\n                        </>\n                      }\n                    />\n                    <Menu\n                      anchorEl={anchorElComment}\n                      open={Boolean(anchorElComment)}\n                      onClose={handleCloseComment}\n                    >\n                      <MenuItem onClick={handleEditPost}>Edit</MenuItem>\n                      <MenuItem onClick={() => handleDeleteComment(commentIdToDelete)}>Delete</MenuItem>\n                    </Menu>\n                  </div>\n                </div>\n              );\n            })}\n            {comments.length > maxDisplayedComments && (\n              <Typography\n                className=\"showMoreComments\"\n                variant=\"body2\"\n                color=\"primary\"\n                onClick={() => setShowAllComments(!showAllComments)}\n              >\n                {showAllComments ? \"Hide\" : \"Show More\"} Comments\n              </Typography>\n            )}\n            <TextField\n              label=\"Add a comment\"\n              variant=\"outlined\"\n              value={newCommentText}\n              onChange={(e) => setNewCommentText(e.target.value)}\n              fullWidth\n              style={{ color: isLiked ? 'inherit' : '#6200E8' }}\n            />\n            <Button\n              variant=\"contained\"\n              onClick={() => submitComment(post.id, newCommentText, user.member_id)}\n            >\n              Comment\n            </Button>\n          </CardContent>\n          )}\n        </Collapse>\n      </Card>\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}